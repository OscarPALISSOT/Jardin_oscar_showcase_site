FROM node:latest

WORKDIR /app

COPY . .

ENV NEXT_PUBLIC_DIRECTUS_URL=https://backend.jardindoscar.fr
ENV NEXT_PUBLIC_ASSETS_URL=${NEXT_PUBLIC_DIRECTUS_URL}/assets/

ARG NEXT_PUBLIC_RECAPTCHA_CLIENT_KEY
ENV NEXT_PUBLIC_RECAPTCHA_CLIENT_KEY=${NEXT_PUBLIC_RECAPTCHA_CLIENT_KEY}
ARG RECAPTCHA_SECRET_KEY
ENV RECAPTCHA_SECRET_KEY=${RECAPTCHA_SECRET_KEY}

RUN npm install

RUN npm run build

EXPOSE 3000

CMD ["npm", "start"]
